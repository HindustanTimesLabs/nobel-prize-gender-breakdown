<!DOCTYPE html>
<meta charset="utf-8">
<body>
  <style>
  body {
    margin: 0;
  }
  </style>
</body>
<script src="d3.v4.min.js"></script>
<script>

var width = window.innerWidth;
var height = window.innerHeight;
// append canvas
var svg = d3.select("body").append("svg")
  .attr("width", width)
  .attr("height", height)

var colors = {male: "#48a2d7", female: "#e74c3c", org: "#ccc"}

d3.csv("all.csv", function(error, data){
  if (error) throw error;

  var simulation = d3.forceSimulation(data)
    .force("y1", isolate(d3.forceY(-height / 8), function(d){ return d.type == "medicine" || d.type == "physics" || d.type == "chemistry"; }))
    .force("y2", isolate(d3.forceY(height / 8), function(d){ return d.type == "peace" || d.type == "literature" || d.type == "economic-sciences"; }))
    .force("x1", isolate(d3.forceX(-width / 6), function(d) { return d.type === "medicine" || d.type == "peace"; }))
    .force("x2", isolate(d3.forceX(), function(d) { return d.type === "physics" || d.type == "literature"; }))
    .force("x3", isolate(d3.forceX(width / 6), function(d) { return d.type === "chemistry" || d.type == "economic-sciences"; }))
    .force("charge", d3.forceManyBody().strength(-10))
    .on("tick", redraw);

  function redraw() {
    
    var circle = svg.selectAll("circle")
        .data(data, function(d){ return d.url; })

    //update
    circle
        .attr("cx", function(d){ return d.x; })
        .attr("cy", function(d){ return d.y; })

    //enter
    circle.enter().append("circle")
        .attr("cx", function(d){ return d.x; })
        .attr("cy", function(d){ return d.y; })
        .attr("transform", "translate(" + width / 2 + "," + height /2 + ")")
        .attr("r", 7)
        .style("fill", function(d){ return colors[d.gender]; });

    simulation.alpha(1)

  }

  function drawNode(d) {
    context.beginPath();
    context.moveTo(d.x, d.y);
    context.arc(d.x, d.y, 7, 0, 2 * Math.PI);
    context.fillStyle = colors[d.gender];
    context.strokeStyle = "black";
    context.stroke();
    context.fill();
  }

  function isolate(force, filter) {
    var initialize = force.initialize;
    force.initialize = function() { initialize.call(force, data.filter(filter)); };
    return force;
  }


});




</script>
